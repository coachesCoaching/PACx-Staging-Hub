<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PACx Demo Hub</title>
  <style>
    :root{ --bg:#0f1223; --panel:#161a2e; --text:#eaf0ff; --sub:#a8b1d1; --mint:#56f3a6; --border:#2a2f4a; }
    *{ box-sizing:border-box }
    body{ margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; background:var(--bg); color:var(--text); }
    .wrap{ max-width:1080px; margin:0 auto; padding:28px 18px 80px; }
    .hdr{ display:flex; align-items:center; gap:12px; margin-bottom:14px; }
    .dot{ width:12px; height:12px; background:#29eb7f; border-radius:6px; display:inline-block; }
    .title{ font-size:28px; font-weight:900; color:var(--mint) }
    .toolbar{ display:flex; gap:10px; align-items:center; margin:8px 0 18px }
    .btn{ background:#0f1223; color:var(--text); border:1px solid var(--border); border-radius:12px; padding:8px 12px; text-decoration:none; }
    .grid{ display:grid; gap:14px; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); margin-top:8px; }
    .card{ display:block; background:var(--panel); border:1px solid var(--border); border-radius:16px; padding:16px; color:inherit; text-decoration:none; }
    .card h3{ margin:0 0 6px; font-size:18px; }
    .sub{ color:var(--sub); min-height:36px; }
    .open{ display:inline-block; margin-top:10px; color:#cfe7ff; text-decoration:underline; }
    .note{ color:var(--sub); font-size:12px; border-top:1px dashed var(--border); padding-top:10px; margin-top:20px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hdr">
      <span class="dot"></span>
      <div class="title">PACx Demo’s</div>
    </div>

    <div class="toolbar">
      <a class="btn" id="refresh" href="#">Refresh</a>
      <a class="btn" href="admin.html">Admin</a>
      <small id="last" style="color:var(--sub)"></small>
    </div>

    <div id="grid" class="grid" aria-live="polite"></div>

    <p class="note">Tiles are read from <code>/data/canvases.json</code>. If a link is invalid, open Admin to update.</p>
  </div>

  <script>
    const grid = document.getElementById('grid');
    const last = document.getElementById('last');
    document.getElementById('refresh').addEventListener('click', (e)=>{ e.preventDefault(); load(); });

    function card(t){
      const a = document.createElement('a');
      a.className = 'card';
      a.target = '_blank';
      a.rel = 'noopener noreferrer';
      a.href = t.url || '#';
      a.innerHTML = `
        <h3>${t.title || 'Untitled'}</h3>
        <div class="sub">${t.description || ''}</div>
        <span class="open">Open</span>
      `;
      if (!/^https?:\/\//i.test(t.url||'')) { a.href = '#'; a.addEventListener('click', (e)=>e.preventDefault()); }
      return a;
    }
    async function load(){
      try{
        const res = await fetch('./data/canvases.json', {cache:'no-store'});
        const data = await res.json();
        grid.innerHTML = '';
        (data.titles||[]).forEach(t => grid.appendChild(card(t)));
        last.textContent = data.updatedAt ? `Updated ${data.updatedAt}` : '';
      }catch(err){
        grid.innerHTML = '<div class="sub">Could not load canvases.json</div>';
      }
    }
    load();
  </script>

  <!-- PACx Feedback + Back (back arrow is hidden on hub automatically) -->
  <script>
    // On hub we *don’t* want a back arrow; leave PACX_BACK_HREF undefined here.
    window.PACX_FEEDBACK_URL = 'https://docs.google.com/forms/d/e/REPLACE_ME/viewform?embedded=true';
  </script>
  <script src="./pacx-feedback.js" defer></script>
</body>
</html>
